{"ast":null,"code":"/**\n * @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nimport * as axis_util from '../ops/axis_util';\nimport { cast } from '../ops/cast';\nimport { equal } from '../ops/equal';\nimport { mul } from '../ops/mul';\nimport { reshape } from '../ops/reshape';\n/**\n * Gradient helper function for the min and max operations.\n */\n\nexport function gradForMinAndMax(dy, y, xOrig, origAxes) {\n  if (y.rank < xOrig.rank) {\n    y = reshape(y, axis_util.expandShapeToKeepDim(y.shape, origAxes));\n  }\n\n  if (dy.rank < xOrig.rank) {\n    dy = reshape(dy, axis_util.expandShapeToKeepDim(dy.shape, origAxes));\n  }\n\n  return {\n    x: () => {\n      const dx = mul(dy, cast(equal(xOrig, y), dy.dtype));\n      return dx;\n    }\n  };\n}","map":{"version":3,"sources":["../../src/gradients/min_max_grad_util.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;AAeG;AAEH,OAAO,KAAK,SAAZ,MAA2B,kBAA3B;AACA,SAAQ,IAAR,QAAmB,aAAnB;AACA,SAAQ,KAAR,QAAoB,cAApB;AACA,SAAQ,GAAR,QAAkB,YAAlB;AACA,SAAQ,OAAR,QAAsB,gBAAtB;AAGA;;AAEG;;AACH,OAAM,SAAU,gBAAV,CACF,EADE,EACK,CADL,EACW,KADX,EAC0B,QAD1B,EAC4C;AAChD,MAAI,CAAC,CAAC,IAAF,GAAS,KAAK,CAAC,IAAnB,EAAyB;AACvB,IAAA,CAAC,GAAG,OAAO,CAAC,CAAD,EAAI,SAAS,CAAC,oBAAV,CAA+B,CAAC,CAAC,KAAjC,EAAwC,QAAxC,CAAJ,CAAX;AACD;;AACD,MAAI,EAAE,CAAC,IAAH,GAAU,KAAK,CAAC,IAApB,EAA0B;AACxB,IAAA,EAAE,GAAG,OAAO,CAAC,EAAD,EAAK,SAAS,CAAC,oBAAV,CAA+B,EAAE,CAAC,KAAlC,EAAyC,QAAzC,CAAL,CAAZ;AACD;;AACD,SAAO;AACL,IAAA,CAAC,EAAE,MAAK;AACN,YAAM,EAAE,GAAG,GAAG,CAAC,EAAD,EAAK,IAAI,CAAC,KAAK,CAAC,KAAD,EAAQ,CAAR,CAAN,EAAkB,EAAE,CAAC,KAArB,CAAT,CAAd;AACA,aAAO,EAAP;AACD;AAJI,GAAP;AAMD","sourceRoot":"","sourcesContent":["/**\n * @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nimport * as axis_util from '../ops/axis_util';\nimport { cast } from '../ops/cast';\nimport { equal } from '../ops/equal';\nimport { mul } from '../ops/mul';\nimport { reshape } from '../ops/reshape';\n/**\n * Gradient helper function for the min and max operations.\n */\nexport function gradForMinAndMax(dy, y, xOrig, origAxes) {\n    if (y.rank < xOrig.rank) {\n        y = reshape(y, axis_util.expandShapeToKeepDim(y.shape, origAxes));\n    }\n    if (dy.rank < xOrig.rank) {\n        dy = reshape(dy, axis_util.expandShapeToKeepDim(dy.shape, origAxes));\n    }\n    return {\n        x: () => {\n            const dx = mul(dy, cast(equal(xOrig, y), dy.dtype));\n            return dx;\n        }\n    };\n}\n//# sourceMappingURL=min_max_grad_util.js.map"]},"metadata":{},"sourceType":"module"}